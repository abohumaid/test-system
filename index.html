<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø´Ø±ÙƒØ©</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f2f2f2;
            color: #333;
            direction: rtl;
            padding: 20px;
        }
        h2, h3 {
            color: #006699;
        }
        label {
            margin: 10px 0;
            font-weight: bold;
        }
        input, select, button {
            padding: 8px;
            margin-top: 5px;
            width: 100%;
            max-width: 400px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 18px;
        }
        button {
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #0056b3;
        }
        .hidden {
            display: none;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        th {
            background-color: #006699;
            color: white;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        button {
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        
        button:hover {
            background-color: #0056b3;
        }
        
    </style>
</head>
<body>
    <h3>Eng.Ahmed</h3>
    <h2>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h2>
    <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: <input type="text" id="name"></label>
    <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: <input type="text" id="phone"></label><br>
    <label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø¢Ø®Ø±: <input type="text" id="otherPhone"></label>
    <label>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: 
        <select id="governorate" onchange="updateRegions()" oninput="filterOptions('governorate')">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
            <option value="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
            <option value="Ø§Ù„Ø¬ÙŠØ²Ø©">Ø§Ù„Ø¬ÙŠØ²Ø©</option>
        </select><br>
    </label>
    <label>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: 
        <select id="region" oninput="filterOptions('region')">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</option>
        </select>
    </label>
<div class="fixed-buttons">
    <button onclick="toggleInquiry()">Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª</button>
    <button onclick="toggleComplaint()">Ø§Ù„Ù…Ø´Ø§ÙƒÙ„</button>
</div>
    <div id="inquirySection" class="hidden">
        <label>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±:
            <select id="inquiryType" onchange="updateInquiryNames()" oninput="filterOptions('inquiryType')">
                <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±</option>
                <option value="Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ø§Ù…">Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ø§Ù…</option>
                <option value="Ø§Ø³ØªÙØ³Ø§Ø± Ø®Ø§Øµ">Ø§Ø³ØªÙØ³Ø§Ø± Ø®Ø§Øµ</option>
            </select>
        </label>
        <label>Ø§Ø³Ù… Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±:
            <select id="inquiryName"  oninput="filterOptions('inquiryName')">
                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø§Ø³Ù…</option>
            </select><br>
        </label>
        <label>Ø´Ø±Ø­ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±: <input type="text" id="inquiryDetails"></label>
        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±: <input type="date" id="inquiryDate"></label><br>
        <label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù: <input type="text" id="employeeName"></label>
    </div>

    <div id="complaintSection" class="hidden">
        <label>Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰:
            <select id="complaintType" onchange="updateComplaintNames()"  oninput="filterOptions('complaintType')">
                <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰</option>
                <option value="Ø´ÙƒÙˆÙ‰ Ø¹Ø§Ù…Ø©">Ø´ÙƒÙˆÙ‰ Ø¹Ø§Ù…Ø©</option>
                <option value="Ø´ÙƒÙˆÙ‰ Ø®Ø§ØµØ©">Ø´ÙƒÙˆÙ‰ Ø®Ø§ØµØ©</option>
            </select>
        </label>
        <label>Ø§Ø³Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰:
            <select id="complaintName" oninput="filterOptions('complaintName')">
                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø§Ø³Ù…</option>
            </select><br>
        </label>
        <label>ÙˆØµÙ Ø§Ù„Ø´ÙƒÙˆÙ‰: <input type="text" id="complaintDetails"></label>
        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø´ÙƒÙˆÙ‰: <input type="date" id="complaintDate"></label><br>
        <label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù: <input type="text" id="employeeNameComplaint"></label>
    </div>

    <button onclick="saveData()">Ø­ÙØ¸</button>
    <button onclick="searchClient()">Ø¨Ø­Ø«</button>
    <button onclick="deleteClient()">Ø­Ø°Ù</button>
    <button onclick="clearFields()">Ø¥Ø¶Ø§ÙØ©</button>
    <button onclick="showTable()">Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„</button>
    <button onclick="exportToExcel()">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¬Ø¯ÙˆÙ„</button>
    <button id="importFileButton">Ø¥Ø¯Ø®Ø§Ù„ Ù…Ù„Ù</button>



    <h3>ÙÙ„ØªØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
    <label>Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…: <input type="text" id="filterName" oninput="filterTable()"></label>
    <label>Ø¨Ø­Ø« Ø¨Ø§Ù„ØªØ§Ø±ÙŠØ®: <input type="date" id="filterDate" oninput="filterTable()"></label>
    <label>Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: 
        <input type="text" id="filterPhone">
        <button onclick="filterByPhone()">Ø¨Ø­Ø«</button>
    </label>

    <table id="dataTable" class="hidden">
        <thead>
            <tr>
                <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th><th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th><th>Ø±Ù‚Ù… Ø¢Ø®Ø±</th><th>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</th><th>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th>
                <th>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±</th><th>Ø§Ø³Ù… Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±</th><th>Ø´Ø±Ø­ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±</th><th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±</th><th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</th>
                <th>Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>Ø§Ø³Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>ÙˆØµÙ Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>

    <h3 id="inquiriesHeader" class="hidden">Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>
    <table id="inquiriesTable" class="hidden">
        <thead>
            <tr>
                <th>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±</th><th>Ø§Ø³Ù… Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±</th><th>Ø´Ø±Ø­ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±</th><th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±</th><th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</th>
            </tr>
        </thead>
        <tbody id="inquiriesBody"></tbody>
    </table>

    <h3 id="complaintsHeader" class="hidden">Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>
    <table id="complaintsTable" class="hidden">
        <thead>
            <tr>
                <th>Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>Ø§Ø³Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>ÙˆØµÙ Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</th>
            </tr>
        </thead>
        <tbody id="complaintsBody"></tbody>
    </table>

    <script>
        let clients = [];

        const regionData = {
            'Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©': ['Ù…Ø¯ÙŠÙ†Ø© Ù†ØµØ±', 'Ø§Ù„Ù…Ø¹Ø§Ø¯ÙŠ', 'Ø­Ù„ÙˆØ§Ù†'],
            'Ø§Ù„Ø¬ÙŠØ²Ø©': ['Ø§Ù„Ø¯Ù‚ÙŠ', 'Ø§Ù„Ù‡Ø±Ù…', 'ÙÙŠØµÙ„']
        };

        function updateRegions() {
            const gov = document.getElementById('governorate').value;
            const region = document.getElementById('region');
            region.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</option>';
            if (regionData[gov]) {
                regionData[gov].forEach(r => {
                    const opt = document.createElement('option');
                    opt.value = r;
                    opt.textContent = r;
                    region.appendChild(opt);
                });
            }
        }

        function toggleInquiry() {
            document.getElementById('inquirySection').classList.remove('hidden');
            document.getElementById('complaintSection').classList.add('hidden');
        }

        function toggleComplaint() {
            document.getElementById('complaintSection').classList.remove('hidden');
            document.getElementById('inquirySection').classList.add('hidden');
        }

        // Update inquiry names based on inquiryType
        document.getElementById('inquiryType').addEventListener('change', updateInquiryNames);
        function updateInquiryNames() {
            const type = document.getElementById('inquiryType').value;
            const sel = document.getElementById('inquiryName');
            sel.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø§Ø³Ù…</option>';
            let opts = [];
            if (type === 'Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ø§Ù…') opts = ['Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ø§Ù… 1 ', 'Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ø§Ù… 2'];
            else if (type === 'Ø§Ø³ØªÙØ³Ø§Ø± Ø®Ø§Øµ') opts = ['Ø§Ø³ØªÙØ³Ø§Ø± Ø®Ø§Øµ 1', 'Ø§Ø³ØªÙØ³Ø§Ø± Ø®Ø§Øµ 2'];
            opts.forEach(n => {
                const o = document.createElement('option');
                o.value = n; o.textContent = n;
                sel.appendChild(o);
            });
        }

        // Update complaint names based on complaintType
        document.getElementById('complaintType').addEventListener('change', updateComplaintNames);
        function updateComplaintNames() {
            const type = document.getElementById('complaintType').value;
            const sel = document.getElementById('complaintName');
            sel.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø§Ø³Ù…</option>';
            let opts = [];
            if (type === 'Ø´ÙƒÙˆÙ‰ Ø¹Ø§Ù…Ø©') opts = ['Ø´ÙƒÙˆÙŠ Ø¹Ø§Ù…Ø© 1', 'ÙƒØ´ÙˆÙŠ Ø¹Ø§Ù…Ø©2'];
              else if (type === 'Ø´ÙƒÙˆÙ‰ Ø®Ø§ØµØ©') opts = ['Ø´ÙƒÙˆÙŠ Ø®Ø§ØµØ© 1', 'Ø´ÙƒÙˆÙŠ Ø®Ø§Øµ 2'];;
            opts.forEach(n => {
                const o = document.createElement('option');
                o.value = n; o.textContent = n;
                sel.appendChild(o);
            });
        }

        function saveData() {
    // Ø¬Ù„Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„
    const inquiryType = document.getElementById('inquiryType').value.trim();
    const inquiryName = document.getElementById('inquiryName').value.trim();
    const inquiryDetails = document.getElementById('inquiryDetails').value.trim();
    const inquiryDate = document.getElementById('inquiryDate').value.trim();
    const employeeName = document.getElementById('employeeName').value.trim();

    const complaintType = document.getElementById('complaintType').value.trim();
    const complaintName = document.getElementById('complaintName').value.trim();
    const complaintDetails = document.getElementById('complaintDetails').value.trim();
    const complaintDate = document.getElementById('complaintDate').value.trim();
    const employeeNameComplaint = document.getElementById('employeeNameComplaint').value.trim();

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù„ÙŠØ³Øª ÙƒÙ„Ù‡Ø§ ÙØ§Ø¶ÙŠØ©
    const isInquiryFilled = inquiryType || inquiryName || inquiryDetails || inquiryDate || employeeName;
    const isComplaintFilled = complaintType || complaintName || complaintDetails || complaintDate || employeeNameComplaint;

    if (!isInquiryFilled && !isComplaintFilled) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰ Ø£Ùˆ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸.');
        return; // Ø¥ÙŠÙ‚Ø§Ù Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­ÙØ¸
    }

    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    const d = {
        name: document.getElementById('name').value,
        phone: document.getElementById('phone').value,
        otherPhone: document.getElementById('otherPhone').value,
        governorate: document.getElementById('governorate').value,
        region: document.getElementById('region').value,
        inquiryType,
        inquiryName,
        inquiryDetails,
        inquiryDate,
        employeeName,
        complaintType,
        complaintName,
        complaintDetails,
        complaintDate,
        employeeNameComplaint
    };
    clients.push(d);
    alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');

    // ØªÙØ±ÙŠØº Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ø§Ù„Ø´ÙƒÙˆÙ‰ ÙˆØ§Ù„Ø§Ø³ØªÙØ³Ø§Ø± ÙÙ‚Ø·
    document.getElementById('inquiryType').value = '';
    document.getElementById('inquiryName').innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø§Ø³Ù…</option>';
    document.getElementById('inquiryDetails').value = '';
    document.getElementById('inquiryDate').value = '';
    document.getElementById('employeeName').value = '';

    document.getElementById('complaintType').value = '';
    document.getElementById('complaintName').innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø§Ø³Ù…</option>';
    document.getElementById('complaintDetails').value = '';
    document.getElementById('complaintDate').value = '';
    document.getElementById('employeeNameComplaint').value = '';
}



       function searchClient() {
    const phone = prompt('Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„Ø¨Ø­Ø«:');
    const client = clients.find(c => c.phone === phone);
    if (!client) return alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…ÙŠÙ„ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…');

    // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
    document.getElementById('name').value = client.name;
    document.getElementById('phone').value = client.phone;
    document.getElementById('otherPhone').value = client.otherPhone;
    document.getElementById('governorate').value = client.governorate;
    updateRegions();
    document.getElementById('region').value = client.region;

    // ØªÙØ±ÙŠØº Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±
    document.getElementById('inquiryType').value = '';
    updateInquiryNames();
    document.getElementById('inquiryName').value = '';
    document.getElementById('inquiryDetails').value = '';
    document.getElementById('inquiryDate').value = '';
    document.getElementById('employeeName').value = '';

    // ØªÙØ±ÙŠØº Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´ÙƒÙˆÙ‰
    document.getElementById('complaintType').value = '';
    updateComplaintNames();
    document.getElementById('complaintName').value = '';
    document.getElementById('complaintDetails').value = '';
    document.getElementById('complaintDate').value = '';
    document.getElementById('employeeNameComplaint').value = '';

    // Ø¹Ø±Ø¶ Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø´ÙƒØ§ÙˆÙ‰
    const ib = document.getElementById('inquiriesBody');
    ib.innerHTML = '';
    clients.filter(c => c.phone === phone && c.inquiryDetails)
        .forEach(i => {
            ib.innerHTML += `<tr>
                <td>${i.inquiryType}</td>
                <td>${i.inquiryName}</td>
                <td>${i.inquiryDetails}</td>
                <td>${i.inquiryDate}</td>
                <td>${i.employeeName}</td>
            </tr>`;
        });
    document.getElementById('inquiriesTable').classList.remove('hidden');
    document.getElementById('inquiriesHeader').classList.remove('hidden');

    const cb = document.getElementById('complaintsBody');
    cb.innerHTML = '';
    clients.filter(c => c.phone === phone && c.complaintDetails)
        .forEach(c => {
            cb.innerHTML += `<tr>
                <td>${c.complaintType}</td>
                <td>${c.complaintName}</td>
                <td>${c.complaintDetails}</td>
                <td>${c.complaintDate}</td>
                <td>${c.employeeNameComplaint}</td>
            </tr>`;
        });
    document.getElementById('complaintsTable').classList.remove('hidden');
    document.getElementById('complaintsHeader').classList.remove('hidden');
}


        function deleteClient() {
            const phone = prompt('Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„Ø­Ø°Ù:');
            clients = clients.filter(c => c.phone !== phone);
            alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§');
        }

        function showTable() {
            const tb = document.getElementById('tableBody');
            tb.innerHTML = '';
            clients.forEach(c => {
                tb.innerHTML += `<tr>
                    <td>${c.name}</td>
                    <td>${c.phone}</td>
                    <td>${c.otherPhone}</td>
                    <td>${c.governorate}</td>
                    <td>${c.region}</td>
                    <td>${c.inquiryType}</td>
                    <td>${c.inquiryName}</td>
                    <td>${c.inquiryDetails}</td>
                    <td>${c.inquiryDate}</td>
                    <td>${c.employeeName}</td>
                                        <td>${c.complaintType}</td>
                    <td>${c.complaintName}</td>
                    <td>${c.complaintDetails}</td>
                    <td>${c.complaintDate}</td>
                    <td>${c.employeeNameComplaint}</td>
                </tr>`;
            });
            document.getElementById('dataTable').classList.remove('hidden');
        }

        function filterTable() {
            const nameFilter = document.getElementById('filterName').value.toLowerCase();
            const dateFilter = document.getElementById('filterDate').value;
            const phoneFilter = document.getElementById('filterPhone').value;

            const filteredClients = clients.filter(client => {
                const matchesName = client.name.toLowerCase().includes(nameFilter);
                const matchesDate = !dateFilter || client.inquiryDate === dateFilter || client.complaintDate === dateFilter;
                const matchesPhone = !phoneFilter || client.phone.includes(phoneFilter);

                return matchesName && matchesDate && matchesPhone;
            });

            const tb = document.getElementById('tableBody');
            tb.innerHTML = '';
            filteredClients.forEach(client => {
                tb.innerHTML += `<tr>
                    <td>${client.name}</td>
                    <td>${client.phone}</td>
                    <td>${client.otherPhone}</td>
                    <td>${client.governorate}</td>
                    <td>${client.region}</td>
                    <td>${client.inquiryType}</td>
                    <td>${client.inquiryName}</td>
                    <td>${client.inquiryDetails}</td>
                    <td>${client.inquiryDate}</td>
                    <td>${client.employeeName}</td>
                    <td>${client.complaintType}</td>
                    <td>${client.complaintName}</td>
                    <td>${client.complaintDetails}</td>
                    <td>${client.complaintDate}</td>
                    <td>${client.employeeNameComplaint}</td>
                </tr>`;
            });
        }

        function filterByPhone() {
            const phone = document.getElementById('filterPhone').value;
            const filteredClients = clients.filter(client => client.phone.includes(phone));

            const tb = document.getElementById('tableBody');
            tb.innerHTML = '';
            filteredClients.forEach(client => {
                tb.innerHTML += `<tr>
                    <td>${client.name}</td>
                    <td>${client.phone}</td>
                    <td>${client.otherPhone}</td>
                    <td>${client.governorate}</td>
                    <td>${client.region}</td>
                    <td>${client.inquiryType}</td>
                    <td>${client.inquiryName}</td>
                    <td>${client.inquiryDetails}</td>
                    <td>${client.inquiryDate}</td>
                    <td>${client.employeeName}</td>
                    <td>${client.complaintType}</td>
                    <td>${client.complaintName}</td>
                    <td>${client.complaintDetails}</td>
                    <td>${client.complaintDate}</td>
                    <td>${client.employeeNameComplaint}</td>
                </tr>`;
            });
        }

        function clearFields() {
            document.getElementById('name').value = '';       
            document.getElementById('phone').value = '';
            document.getElementById('otherPhone').value = '';
            document.getElementById('governorate').value = '';
            document.getElementById('region').value = '';
            document.getElementById('inquiryType').value = '';
            document.getElementById('inquiryName').value = '';
            document.getElementById('inquiryDetails').value = '';
            document.getElementById('inquiryDate').value = '';
            document.getElementById('employeeName').value = '';
            document.getElementById('complaintType').value = '';
            document.getElementById('complaintName').value = '';
            document.getElementById('complaintDetails').value = '';
            document.getElementById('complaintDate').value = '';
            document.getElementById('employeeNameComplaint').value = '';
        }
        function filterOptions(id) {
            const input = document.getElementById(id);
            const datalist = document.getElementById(id === 'governorate' ? 'governorates' : 'regions');
            const filter = input.value.toLowerCase();
        
            const options = datalist.getElementsByTagName('option');
            for (let option of options) {
                if (option.value.toLowerCase().startsWith(filter)) {
                    option.style.display = 'block'; // Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…ØªÙˆØ§ÙÙ‚Ø©
                } else {
                    option.style.display = 'none'; // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± ØºÙŠØ± Ø§Ù„Ù…ØªÙˆØ§ÙÙ‚Ø©
                }
            }
        }
        
      function exportToExcel() {
    if (clients.length === 0) {
        alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬Ù‡Ø§.");
        return;
    }

    const worksheetData = [
        ["Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„", "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ", "Ø±Ù‚Ù… Ø¢Ø®Ø±", "Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©", "Ø§Ù„Ù…Ù†Ø·Ù‚Ø©",
         "Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±", "Ø§Ø³Ù… Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±", "Ø´Ø±Ø­ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±", "Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù",
         "Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰", "Ø§Ø³Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰", "ÙˆØµÙ Ø§Ù„Ø´ÙƒÙˆÙ‰", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø´ÙƒÙˆÙ‰", "Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù"]
    ];

    clients.forEach(c => {
        worksheetData.push([
            c.name, c.phone, c.otherPhone, c.governorate, c.region,
            c.inquiryType, c.inquiryName, c.inquiryDetails, c.inquiryDate, c.employeeName,
            c.complaintType, c.complaintName, c.complaintDetails, c.complaintDate, c.employeeNameComplaint
        ]);
    });

    const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, "Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡");

    const excelFile = XLSX.write(workbook, { bookType: "xlsx", type: "binary" });

    function s2ab(s) {
        const buf = new ArrayBuffer(s.length);
        const view = new Uint8Array(buf);
        for (let i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
        return buf;
    }

    const blob = new Blob([s2ab(excelFile)], { type: "application/octet-stream" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "Ø¨ÙŠØ§Ù†Ø§Øª_Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡.xlsx";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);

    // ğŸ‰ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
    alert("âœ… ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­ Ø¥Ù„Ù‰ Ø§Ù„ØªÙ†Ø²ÙŠÙ„Ø§Øª.");
}
document.getElementById("importFileButton").addEventListener("click", function() {
    // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± input Ù„Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.xlsx';

    // Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ù…Ù„Ù
    input.addEventListener("change", function(e) {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(event) {
            const data = event.target.result;

            // Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù Excel
            const workbook = XLSX.read(data, { type: 'binary' });

            // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´ÙŠØª Ø§Ù„Ø£ÙˆÙ„
            const sheet = workbook.Sheets[workbook.SheetNames[0]];

            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ JSON
            const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

            // Ø¥Ø²Ø§Ù„Ø© Ø±Ø£Ø³ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£ÙˆÙ„
            jsonData.shift();

            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†
            jsonData.forEach(row => {
                const client = {
                    name: row[0],
                    phone: row[1],
                    otherPhone: row[2],
                    governorate: row[3],
                    region: row[4],
                    inquiryType: row[5],
                    inquiryName: row[6],
                    inquiryDetails: row[7],
                    inquiryDate: row[8],
                    employeeName: row[9],
                    complaintType: row[10],
                    complaintName: row[11],
                    complaintDetails: row[12],
                    complaintDate: row[13],
                    employeeNameComplaint: row[14],
                };
                clients.push(client); // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
            });

            alert("ØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­!");
        };

        // Ù‚Ø±Ø§Ø¡Ø© Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ù…Ù„Ù
        reader.readAsBinaryString(file);
    });

    // ØªÙØ¹ÙŠÙ„ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
    input.click();
});

function searchClientByPhone(phoneNumber) {
    const client = clients.find(c => c.phone === phoneNumber || c.otherPhone === phoneNumber);
    if (client) {
        // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        alert(`Ø§Ù„Ø¹Ù…ÙŠÙ„: ${client.name}\nØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${client.phone}\nØ§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${client.governorate}\nØ§Ù„Ù…Ù†Ø·Ù‚Ø©: ${client.region}`);
    } else {
        alert("Ø§Ù„Ø¹Ù…ÙŠÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯.");
    }
}




        
    </script>
</body>
</html>